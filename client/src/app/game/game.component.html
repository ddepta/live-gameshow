<div class="game-container" *ngIf="gameData && currentQuestion">
  <div
    class="content"
    [ngClass]="{
      'animate-out-left': isAnimatingOut && animationDirection === 'next',
      'animate-out-right': isAnimatingOut && animationDirection === 'prev',
      'animate-in-right': isAnimatingIn && animationDirection === 'next',
      'animate-in-left': isAnimatingIn && animationDirection === 'prev'
    }"
  >
    <!-- Question container - hidden for participants until sent by moderator -->
    <div
      class="game-view-container"
      *ngIf="isModerator || isQuestionVisibleToParticipants"
    >
      <div class="game-info">
        <div class="question-content">
          <!-- Left navigation arrow - only visible to moderator -->
          <div class="nav-left-container" *ngIf="isModerator">
            <button
              class="nav-arrow nav-arrow-left"
              [disabled]="currentQuestionIndex === 0 || isAnimating"
              (click)="previousQuestion()"
            >
              <ng-icon name="typChevronLeft"></ng-icon>
            </button>
            <!-- Empty div to match the structure of the right container -->
            <div class="nav-placeholder"></div>
          </div>

          <p class="question-text">{{ currentQuestion.question }}</p>

          <!-- Right navigation arrow - only visible to moderator -->
          <div class="nav-right-container" *ngIf="isModerator">
            <!-- Next question button - at the top -->
            <button
              class="nav-arrow nav-arrow-right"
              [disabled]="
                currentQuestionIndex === gameData.questions.length - 1 ||
                isAnimating
              "
              (click)="nextQuestion()"
            >
              <ng-icon name="typChevronRight"></ng-icon>
            </button>

            <!-- Eye buttons in a row below the next button -->
            <div class="eye-buttons-row">
              <!-- Hide button (left) -->
              <button
                class="nav-arrow nav-arrow-action hide-eye"
                [class.active]="!questionSentToParticipants"
                [disabled]="isAnimating || !questionSentToParticipants"
                (click)="setQuestionVisibility(false)"
                title="Frage ausblenden"
              >
                <ng-icon name="phosphorEyeSlash"></ng-icon>
              </button>

              <!-- Show button (right, aligned beneath next button) -->
              <button
                class="nav-arrow nav-arrow-action show-eye"
                [class.active]="questionSentToParticipants"
                [disabled]="isAnimating || questionSentToParticipants"
                (click)="setQuestionVisibility(true)"
                title="Frage an Teilnehmer senden"
              >
                <ng-icon name="phosphorEye"></ng-icon>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Answer section - exactly match question-content structure -->
      <div class="answer-container"></div>
      <div
        *ngIf="isModerator || isAnswerVisibleToParticipants"
        class="question-answer"
        [class.blurred]="isAnswerBlurred"
        (click)="toggleAnswerBlur()"
      >
        <!-- Left space - match nav-left-container structure -->
        <div class="answer-left-container"></div>

        <!-- Center answer text - match question-text structure -->
        <div class="correct-answer-text">
          Antwort: {{ currentQuestion.correctAnswer }}
        </div>

        <!-- Right space - match nav-right-container structure exactly -->
        <div class="answer-right-container" *ngIf="isModerator">
          <!-- Eye buttons row - match the exact structure in question-content -->
          <div class="answer-eye-buttons-row">
            <button
              class="nav-arrow nav-answer-action hide-eye"
              [class.active]="!answerSentToParticipants"
              [disabled]="isAnimating || !answerSentToParticipants"
              (click)="setAnswerVisibility(false)"
              title="Antwort ausblenden"
            >
              <ng-icon name="phosphorEyeSlash"></ng-icon>
            </button>
            <button
              class="nav-arrow nav-answer-action show-eye"
              [class.active]="answerSentToParticipants"
              [disabled]="isAnimating || answerSentToParticipants"
              (click)="setAnswerVisibility(true)"
              title="Antwort an Teilnehmer senden"
            >
              <ng-icon name="phosphorEye"></ng-icon>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Remove the old moderator controls section -->

    <!-- Game question options - only show when question is visible -->
    <ng-container *ngIf="isModerator || isQuestionVisibleToParticipants">
      <!-- Updated multiple choice section -->
      <div
        class="options-container"
        *ngIf="currentQuestion.type === 'multipleChoice'"
      >
        <div class="options-grid">
          <div
            class="option-btn"
            *ngFor="let option of currentQuestion.options"
          >
            <p-button
              [outlined]="selectedAnswer !== option"
              (onClick)="selectAnswer(option)"
              styleClass="w-full"
              [disabled]="multipleChoiceSubmitted"
            >
              {{ option }}
            </p-button>
          </div>
        </div>

        <!-- Add confirm button -->
        <button
          class="confirm-button"
          [class.submitted]="multipleChoiceSubmitted"
          (click)="confirmMultipleChoice()"
          [disabled]="!selectedAnswer"
        >
          <ng-icon
            [name]="
              multipleChoiceSubmitted
                ? 'phosphorCheckFatFill'
                : 'phosphorCheckFat'
            "
          ></ng-icon>
        </button>
      </div>

      <!-- Buzzer section -->
      <div class="buzzer-container" *ngIf="currentQuestion.type === 'buzzer'">
        <app-buzzer
          [lobbyCode]="lobbyCode"
          [isModerator]="isModerator"
          size="large"
        ></app-buzzer>
      </div>

      <!-- Estimation section -->
      <div
        class="estimation-container"
        *ngIf="currentQuestion.type === 'estimation'"
      >
        <div class="estimation-input-container">
          <textarea
            #estimationInput
            class="estimation-input"
            placeholder="SchÃ¤tzung..."
            [disabled]="estimationSubmitted"
            (input)="adjustFontSize(estimationInput)"
            maxlength="20"
          ></textarea>
        </div>

        <!-- Confirm button for estimation -->
        <button
          class="confirm-button"
          [class.submitted]="estimationSubmitted"
          (click)="submitEstimation(estimationInput.value)"
          [disabled]="!estimationInput.value || estimationSubmitted"
        >
          <ng-icon
            [name]="
              estimationSubmitted ? 'phosphorCheckFatFill' : 'phosphorCheckFat'
            "
          ></ng-icon>
        </button>
      </div>
    </ng-container>

    <!-- Show waiting message when question is not visible -->
    <div
      class="waiting-message"
      *ngIf="!isModerator && !isQuestionVisibleToParticipants"
    >
      <p>Bitte warte, bis der Moderator die Frage freigegeben hat.</p>
    </div>
  </div>

  <!-- Loading state -->
  <div class="loading-info" *ngIf="!gameData">
    <p>Spielinformationen werden geladen...</p>
  </div>
</div>
